# Мои технические долги

## Архитектура и Рефакторинг (High Priority)

### 1. Универсализация боевых компонентов (Combat System 2.0)

- **Контекст:** Мы перешли от спагетти-кода к системе компонентов (`HitboxComponent`, `HurtboxComponent`, `HealthComponent`).
- **Проблема:** Текущая реализация всё ещё "сырая" и требует жесткой настройки в инспекторе, которую легко сломать.
- **Задача (Make abstractions universal):**
  - **Отвязка от сущностей:** Убедиться, что компоненты не зависят от скриптов `Player.gd` или `Mob.gd`. Они должны общаться только через сигналы.
  - **Единый стандарт коллизий:** Задокументировать или автоматизировать настройку `Collision Layers/Masks`, чтобы избежать ситуаций "я бью, но не попадаю".
  - **Расширение функционала:**
    - Добавить поддержку **Knockback (Отталкивания)** в `HitboxComponent` (сейчас мобы толкаются только через физику движения).
    - Добавить поддержку **Teams/Factions** (чтобы мобы не били друг друга, или наоборот — включить Friendly Fire).

### 2. Золото и Инвентарь

- **Состояние:** Логика сбора монет всё ещё находится внутри `gold.gd` и напрямую меняет переменную `body.gold`.
- **Задача:**
  - Создать `InventoryComponent` или перенести логику в `Events`.
  - Сделать так, чтобы монета просто отправляла сигнал `collected`, а `Game` или `Player` уже решали, что с этим делать.

## Баги и Отладка (Medium Priority)

### 3. Исправление визуальных глитчей смерти

- **Симптом:** Анимация может зацикливаться или прерываться ударом.
- **Решение:** Внедрить конечный автомат (State Machine).

## Обучение и Процессы

### 4. Workflow

- **Задача:** Настроить `pre-commit` хуки так, чтобы они не прерывали коммит при успешном авто-форматировании кода (stage изменений автоматически).

### 5. Обновление зависимостей

- **Задача:** Отслеживать выход версии `gdtoolkit`, совместимой с новыми версиями `setuptools` (сейчас зафиксировано `<70.0.0`).
