# Мои технические долги

## Критические

### 1. Боевая система (Взаимодействие урона)

- **Симптом:**
  1. Игрок не получает урон при касании моба (или урон проходит незаметно).
  2. Моб не получает урон от атак игрока.
- **Диагноз:**
  - **Входящий урон:** Скорее всего, зона `Dmage` (в mob.tscn) неправильно настроена (Mask) или у игрока нет визуальной индикации урона (мигание, отбрасывание), из-за чего кажется, что урона нет.
  - **Исходящий урон:** У игрока есть анимация атаки, но нет `HitboxComponent` (Зоны удара), которая включалась бы в нужный кадр анимации и наносила урон врагам в группе `enemies`.
- **Задача:**
  - Проверить Collision Mask у `Dmage` зоны моба.
  - Реализовать `HitboxComponent` для меча игрока.
  - Добавить i-frames (время неуязвимости) игроку, чтобы моб не убивал его за 1 секунду (60 ударов в секунду).

### 2. Золото

- `gold.gd` всё ещё обращается к `body.gold`. Это нужно исправить, перенеся логику в `Events` или компонент инвентаря.

### 3. Обучение

- Переход от копирования кода из видео к использованию паттернов (Композиция, Сигналы).

## Низкий приоритет

### 4. Workflow: Прерывание коммита при авто-форматировании

- **Проблема:** Если `gdformat` автоматически исправляет код при коммите, он помечает хук как Failed и останавливает процесс коммита. Разработчику приходится заново делать `git add`, чтобы добавить исправления, и повторять коммит.
- **Задача:** Настроить `pre-commit` так, чтобы он либо автоматически стейджил изменения (stage), либо не считал успешное форматирование за ошибку (хотя это стандартное поведение pre-commit для безопасности).

### 5. Ограничение версии setuptools<70.0.0

- **Проблема:** `gdtoolkit` (или его зависимости) использует устаревшие функции `pkg_resources`.
- **Временное решение:** В `pyproject.toml` жестко зафиксирована версия `setuptools<70.0.0`.
- **Задача:** Периодически проверять обновления `gdtoolkit`.
